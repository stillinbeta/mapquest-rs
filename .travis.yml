language: rust
cache: cargo
rust:
- stable
- beta
- nightly
script:
- cargo build
- if rustup component add clippy ; then cargo clippy --all-targets -- -D warnings
  ; else echo "no clippy"; fi
matrix:
  allow_failures:
  - rust: nightly
  fast_finish: true
jobs:
  include:
  - stage: deploy
    script: skip
    rust: stable
    deploy:
      provider: cargo
      on:
        tags: true
